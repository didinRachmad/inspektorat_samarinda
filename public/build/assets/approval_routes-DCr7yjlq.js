import{r as i}from"./routes-D3ctfpXk.js";import"./parse-B3pZ8sEA.js";const n={datatable:()=>i("approval_routes.data"),getUsersByRole:s=>i("users.getUsersByRole",{role:s})};class r{constructor(){this.pageName="Approval Routes",this.datatableEl=$("#datatables"),this.moduleSelectEl=$("#module"),this.roleSelectEl=$("#role_id"),this.userSelectEl=$("#assigned_user_id")}initIndex(){console.log(`Halaman ${this.pageName} Index berhasil dimuat!`),this.initDataTable()}initShow(){console.log(`Halaman ${this.pageName} Show berhasil dimuat!`)}initCreate(){console.log(`Halaman ${this.pageName} Create berhasil dimuat!`),this.initSelect2(),this.handleRoleChange()}initEdit(){console.log(`Halaman ${this.pageName} Edit berhasil dimuat!`),this.initSelect2(),this.handleRoleChange(),this.roleSelectEl.val()&&this.roleSelectEl.trigger("change")}initDataTable(){this.datatableEl.DataTable({processing:!0,serverSide:!0,ajax:n.datatable(),columns:[{data:"DT_RowIndex",name:"DT_RowIndex",className:"text-center",orderable:!1,searchable:!1},{data:"id",name:"id",visible:!1},{data:"module",name:"module"},{data:"role",name:"roles.name"},{data:"sequence",name:"sequence"},{data:"assigned_user",name:"users.email",render:t=>t||'<span class="text-muted">-</span>'},{data:null,orderable:!1,searchable:!1,className:"text-center no-export",render:function(t,l,a){let e="";return a.can_edit&&(e+=`
                                <a href="${a.edit_url}" class="btn btn-sm btn-warning rounded-4" data-bs-toggle="tooltip" title="Edit">
                                    <i class="bi bi-pencil-square"></i>
                                </a>`),a.can_delete&&(e+=`
                                <form action="${a.delete_url}" method="POST" class="d-inline form-delete">
                                    <input type="hidden" name="_token" value="${$('meta[name="csrf-token"]').attr("content")}">
                                    <input type="hidden" name="_method" value="DELETE">
                                    <button type="button" class="btn btn-sm btn-danger rounded-4 btn-delete" data-bs-toggle="tooltip" title="Hapus">
                                        <i class="bi bi-trash-fill"></i>
                                    </button>
                                </form>`),`<div class="d-flex justify-content-center gap-1">${e}</div>`}}],dom:"<'row'<'col-md-3'l><'col-md-6 text-center'><'col-md-3'f>><'row py-2'<'col-sm-12 table-responsive'tr>><'row'<'col-md-5'i><'col-md-7'p>>",paging:!0,responsive:!0,pageLength:20,lengthMenu:[[20,50,-1],[20,50,"Semua"]],order:[[1,"desc"]],info:!0,language:{sEmptyTable:"Tidak ada data yang tersedia di tabel",sInfo:"Menampilkan _START_ hingga _END_ dari _TOTAL_ entri",sInfoEmpty:"Menampilkan 0 hingga 0 dari 0 entri",sInfoFiltered:"(disaring dari _MAX_ entri keseluruhan)",sLengthMenu:"Tampilkan _MENU_ entri",sLoadingRecords:"Memuat...",sProcessing:"Sedang memproses...",sSearch:"Cari:",sZeroRecords:"Tidak ditemukan data yang cocok",oAria:{sSortAscending:": aktifkan untuk mengurutkan kolom menaik",sSortDescending:": aktifkan untuk mengurutkan kolom menurun"}},drawCallback:()=>{$('[data-bs-toggle="tooltip"]').each(function(){new bootstrap.Tooltip(this)})}})}initSelect2(){this.moduleSelectEl.select2({placeholder:"Pilih Module",allowClear:!0,theme:"bootstrap-5",width:"100%"}),this.roleSelectEl.select2({placeholder:"Pilih Role",allowClear:!0,theme:"bootstrap-5",width:"100%"}),this.userSelectEl.select2({placeholder:"Pilih User",allowClear:!0,theme:"bootstrap-5",width:"100%",disabled:!0})}handleRoleChange(){this.roleSelectEl.on("change",()=>{const t=this.roleSelectEl.val();this.userSelectEl.val(null).trigger("change").prop("disabled",!t),t&&this.loadUserOptions(t)})}loadUserOptions(t){this.userSelectEl.select2("destroy"),this.userSelectEl.empty().trigger("change"),this.userSelectEl.select2({placeholder:"Pilih User",allowClear:!0,theme:"bootstrap-5",width:"100%",ajax:{url:n.getUsersByRole(t),delay:250,data:e=>({search:e.term,page:e.page||1}),processResults:(e,o)=>({results:e.data,pagination:{more:e.current_page<e.last_page}})}});const l=this.userSelectEl.data("selected-id"),a=this.userSelectEl.data("selected-email");if(l&&a){const e=new Option(a,l,!0,!0);this.userSelectEl.append(e).trigger("change")}}}const u=new r;export{u as default};
