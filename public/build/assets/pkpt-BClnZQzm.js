import{r as o}from"./routes-De8qlvmc.js";import{A as u}from"./dashboard-BIuzU3QB.js";import{a as p}from"./index-ngrFHoWO.js";import"./vendor-BOJsyDNA.js";const c={datatable:()=>o("pkpt.data"),getAnggaran:()=>o("setting_anggaran.getAnggaran")};class b{constructor(){this.pageName="PKPT",this.datatableEl=$("#datatables"),this.anggaranPerHari=17e4}initIndex(){console.log(`Halaman ${this.pageName} Index berhasil dimuat!`),this.initDataTable(),$("#filterMandatory, #filterBulan, #filterTahun, #filterAuditi, #filterIrbanwil, #filterJenisPengawasan").on("change",()=>{$("#datatables").DataTable().ajax.reload()})}initCreate(){console.log(`Halaman ${this.pageName} Create berhasil dimuat!`),this.initForm()}initEdit(){console.log(`Halaman ${this.pageName} Edit berhasil dimuat!`),this.initForm()}initDataTable(){this.datatableEl.DataTable({processing:!0,serverSide:!0,ajax:{url:c.datatable(),type:"GET",data:function(a){a.bulan=$("#filterBulan").val(),a.tahun=$("#filterTahun").val(),a.mandatory_id=$("#filterMandatory").val(),a.auditi_id=$("#filterAuditi").val(),a.irbanwil_id=$("#filterIrbanwil").val(),a.jenis_pengawasan_id=$("#filterJenisPengawasan").val()}},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",orderable:!1,searchable:!1,className:"text-center"},{data:"id",name:"id",visible:!1},{data:"tahun",name:"tahun",className:"text-center"},{data:"bulan",name:"bulan",className:"text-center"},{data:"no_pkpt",name:"no_pkpt"},{data:"mandatory_nama",name:"mandatories.nama"},{data:"auditi_list",render:function(a,l,e,t){if(l==="display"){if(!a)return"";let i=a.split(",").map(n=>n.trim()),r='<ul class="m-0" style="padding-left: 15px; margin:0;">';return i.forEach(n=>r+=`<li>${n}</li>`),r+="</ul>",r}return a}},{data:"sasaran",name:"sasaran"},{data:"ruang_lingkup",name:"ruang_lingkup",render:window.renderSummernoteText},{data:"parent_jenis",name:"parent_jp.nama",className:"text-center"},{data:"jenis_pengawasan",name:"jenis_pengawasans.nama",className:"text-center"},{data:"jadwal_rmp_bulan",name:"jadwal_rmp_bulan"},{data:"jadwal_rsp_bulan",name:"jadwal_rsp_bulan"},{data:"jadwal_rpl_bulan",name:"jadwal_rpl_bulan"},{data:"jadwal_hp_hari",name:"jadwal_hp_hari"},{data:"pj",name:"jabatans.pj",className:"text-center"},{data:"wpj",name:"jabatans.wpj",className:"text-center"},{data:"pt",name:"jabatans.pt",className:"text-center"},{data:"kt",name:"jabatans.kt",className:"text-center"},{data:"at",name:"jabatans.at",className:"text-center"},{data:"anggaran_total",name:"anggaran_total",className:"text-end",render:$.fn.dataTable.render.number(".",",",0,"Rp ")},{data:"irbanwil_nama",name:"irbanwils.nama"},{data:null,orderable:!1,searchable:!1,className:"text-center no-export",render:function(a,l,e){let t="";return e.can_edit&&(t+=`<a href="${e.edit_url}" class="btn btn-sm btn-warning rounded-4" title="Edit"><i class="bi bi-pencil-square"></i></a>`),e.can_delete&&(t+=`
                            <form action="${e.delete_url}" method="POST" class="d-inline form-delete">
                                <input type="hidden" name="_token" value="${$('meta[name="csrf-token"]').attr("content")}">
                                <input type="hidden" name="_method" value="DELETE">
                                <button type="button" class="btn btn-sm btn-danger rounded-4 btn-delete" title="Hapus">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </form>`),`<div class="d-flex justify-content-center gap-1">${t}</div>`}}],dom:"<'row'<'col-md-3'l><'col-md-6 text-center'><'col-md-3'f>><'row table-responsive py-2'<'col-sm-12'tr>><'row'<'col-md-5'i><'col-md-7'p>>",paging:!0,responsive:!0,pageLength:20,lengthMenu:[[20,50,-1],[20,50,"Semua"]],order:[[1,"desc"]],info:!0})}initForm(){p.get(c.getAnggaran()).then(a=>{this.anggaranPerHari=a.data.anggaran,this.hitungSemuaAnggaran()}).catch(()=>{this.anggaranPerHari=17e4}),document.addEventListener("input",a=>{(a.target.matches('[name="jadwal_hp_hari"]')||a.target.matches(".jumlah"))&&this.hitungSemuaAnggaran()})}hitungSemuaAnggaran(){const a=document.querySelector('[name="jadwal_hp_hari"]'),l=parseInt((a==null?void 0:a.value)||0);let e=0;document.querySelectorAll("#jabatanTable tbody tr").forEach(r=>{const n=r.querySelector(".jumlah"),d=r.querySelector(".anggaran"),g=parseInt((n==null?void 0:n.value)||0),s=l*g*this.anggaranPerHari,m=u.getAutoNumericElement(d);m?m.set(s):d.value=s,e+=s});const t=document.getElementById("totalAnggaran"),i=u.getAutoNumericElement(t);i?i.set(e):t.value=e}}const x=new b;export{x as default};
