import{r as s}from"./routes-De8qlvmc.js";const o={datatable:()=>s("regulasi.data"),store:()=>s("regulasi.store"),update:d=>s("regulasi.update",{regulasi:d})};class u{constructor(){this.pageName="Master Regulasi",this.datatableEl=$("#datatables"),this.formEl=document.getElementById("regulasiForm"),this.modalEl=document.getElementById("regulasiModal"),this.modal=new bootstrap.Modal(this.modalEl),this.titleInput=document.getElementById("title"),this.descriptionInput=document.getElementById("description"),this.fileInput=document.getElementById("file"),this.regulasiIdInput=document.getElementById("regulasi_id"),this.currentFileText=document.getElementById("currentFile");const t=document.getElementById("btnTambahRegulasi");t&&t.addEventListener("click",()=>this.resetModal())}initIndex(){console.log(`Halaman ${this.pageName} Index berhasil dimuat!`),this.initDataTable(),this.initFormSubmit()}initDataTable(){const t=this;this.datatableEl.DataTable({processing:!0,serverSide:!0,ajax:o.datatable(),columns:[{data:"DT_RowIndex",name:"DT_RowIndex",className:"text-center",orderable:!1,searchable:!1},{data:"title",name:"title"},{data:"description",name:"description"},{data:null,orderable:!1,searchable:!1,className:"text-center no-export",render:(a,l,e)=>{let i=`<a href="${e.download_url}" class="btn btn-sm btn-success rounded-4" data-bs-toggle="tooltip" title="Download"><i class="bi bi-download"></i></a>`;return e.can_edit&&(i+=`<button type="button" class="btn btn-sm btn-warning rounded-4 btn-edit"
                                data-id="${e.id}"
                                data-title="${e.title}"
                                data-description="${e.description}"
                                data-file="${e.download_url||""}"
                                data-file_path="${e.file_path||""}"
                                data-bs-toggle="tooltip"
                                title="Edit">
                                <i class="bi bi-pencil-square"></i>
                            </button>`),e.can_delete&&(i+=`
                                <form action="${e.delete_url}" method="POST" class="d-inline form-delete">
                                    <input type="hidden" name="_token" value="${$('meta[name="csrf-token"]').attr("content")}">
                                    <input type="hidden" name="_method" value="DELETE">
                                    <button type="button" class="btn btn-sm btn-danger rounded-4 btn-delete" data-bs-toggle="tooltip" title="Hapus">
                                        <i class="bi bi-trash-fill"></i>
                                    </button>
                                </form>
                            `),`<div class="d-flex justify-content-center gap-1">${i}</div>`}}],dom:"<'row'<'col-md-3'l><'col-md-6 text-center'><'col-md-3'f>><'row table-responsive py-2'<'col-sm-12'tr>><'row'<'col-md-5'i><'col-md-7'p>>",paging:!0,responsive:!0,pageLength:20,lengthMenu:[[20,50,-1],[20,50,"Semua"]],order:[[1,"desc"]],info:!0,language:{sEmptyTable:"Tidak ada data yang tersedia di tabel",sInfo:"Menampilkan _START_ hingga _END_ dari _TOTAL_ entri",sInfoFiltered:"(disaring dari _MAX_ entri keseluruhan)",sLengthMenu:"Tampilkan _MENU_ entri",sLoadingRecords:"Memuat...",sProcessing:"Sedang memproses...",sSearch:"Cari:",sZeroRecords:"Tidak ditemukan data yang cocok",oAria:{sSortAscending:": aktifkan untuk mengurutkan kolom menaik",sSortDescending:": aktifkan untuk mengurutkan kolom menurun"}},drawCallback:function(){$('[data-bs-toggle="tooltip"]').each(function(){new bootstrap.Tooltip(this)}),$(".btn-edit").off("click").on("click",function(){const a=$(this);t.fillEditModal({id:a.data("id"),title:a.data("title"),description:a.data("description"),file:a.data("file"),file_path:a.data("file_path")})})}})}resetModal(){this.formEl.reset(),this.regulasiIdInput.value="",this.currentFileText.textContent="",this.modalEl.querySelector(".modal-title").textContent="Tambah Regulasi",this.modal.show()}fillEditModal(t){if(this.regulasiIdInput.value=t.id,this.titleInput.value=t.title,this.descriptionInput.value=t.description,t.file_path){const a=t.file_path.split("/").pop();this.currentFileText.innerHTML=`<a href="${t.file}" target="_blank">${a}</a>`}else this.currentFileText.textContent="";this.modalEl.querySelector(".modal-title").textContent="Edit Regulasi",this.modal.show()}initFormSubmit(){const t=this;this.formEl.addEventListener("submit",function(a){a.preventDefault();const l=new FormData(this),e=t.regulasiIdInput.value;let i=e?o.update(e):o.store();e&&l.append("_method","PUT"),$.ajax({url:i,type:"POST",data:l,processData:!1,contentType:!1,success:function(n){t.modal.hide(),t.datatableEl.DataTable().ajax.reload(),showToast(n.message||"Regulasi berhasil disimpan.","success")},error:function(n){var r;console.error(n),showAlert("Gagal",((r=n.responseJSON)==null?void 0:r.message)||"Terjadi kesalahan","error")}})})}}const c=new u;window.RegulasiPage=c;export{c as default};
